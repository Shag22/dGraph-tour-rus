+++
date =  "2017-04-26T22:28:55+10:00"
next = "/blocksvars/9"
prev = "/blocksvars/7"
title = "Упражнение: переменные значения: sum и avg"
weight = 8
+++

Суммирование sum и усреднение avg могут применяться только к переменным значений, содержащим данные int и float.

Найдите, что больше, количество фильмов Стивена Спилберга (Steven Spielberg) или среднее количество актёров, снятых им.

Этот запрос может быть выполнен в одном блоке, но здесь Вы увидите, как значения доступны и в других блоках, если соответствующий UID доступен для карты значений.

Предупреждение о спойлере:{{% expandable %}}

{
  ID as var(func: allofterms(name@en, "Steven Spielberg")) {
    director.film {
      num_actors as count(starring)
    }
    average as avg(val(num_actors))
  }

  avs(func: uid(ID)) @normalize {
    name : name@en
    average_actors : val(average)
    num_films : count(director.film)
  }
}

{{% /expandable %}}

После того, как выполнится запрос, попробуйте изменить второй блок — подставьте неправильный UID и посмотрите на результат. Например, замените avs на запрос для другого режиссёра вместо использования ID — определение переменной ID также необходимо удалить, иначе оно будет определено, но не использовано.
